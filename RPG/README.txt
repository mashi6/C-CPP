400行あたりまで書き直しています。